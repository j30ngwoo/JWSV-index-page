<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>JW 홈서버 인덱스</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f4f7fa;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 800px;
      margin: auto;
      padding: 2rem;
      text-align: center;
    }

    header h1 {
      color: #333;
      font-size: 2.2rem;
    }

    main {
      margin-top: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .card {
      display: block;
      background: white;
      padding: 1rem;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s, background 0.3s;
      text-decoration: none;
      color: #333;
      font-weight: bold;
      font-size: 1.1rem;
    }

    .card:hover {
      transform: translateY(-3px);
      background: #eef4ff;
    }

    .section-title {
      text-align: left;
      font-size: 1.6rem;
      color: #333;
      font-weight: bold;
      margin: 2.3rem 0 0.3rem 0.1rem;
      letter-spacing: 0.01em;
    }

    .link-row {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      margin-top: 0.5rem;
    }
    .link-row .card {
      flex: 1;
      text-align: center;
    }

    footer {
      margin-top: 3rem;
      color: #aaa;
      font-size: 0.9rem;
    }
    /* --- Server Timer panel --- */
    #server-timer-panel.card { text-align: left; }
    .st-row { display:flex; align-items:center; gap:.75rem; margin:.5rem 0; }
    .st-left { display:flex; gap:.5rem; }
    .st-btn {
      display:inline-block; padding:.55rem .9rem; border-radius:8px;
      background:#1f6feb; color:#fff; text-decoration:none; font-weight:600;
    }
    .st-btn:hover { filter:brightness(1.05); }
    .st-count { margin-left:auto; color:#667085; font-size:.9rem; white-space:nowrap; }
    .st-link { display:inline-block; margin-top:.6rem; color:#1f6feb; text-decoration:none; }
    .st-link:hover { text-decoration:underline; }
  </style>
</head>

<script>
(async () => {
  const OWNER = "j30ngwoo";
  const REPO  = "Server-timer";
  const TAG   = null; // null (최신 릴리즈 사용)

  const endpoint = TAG
    ? `https://api.github.com/repos/${OWNER}/${REPO}/releases/tags/${encodeURIComponent(TAG)}`
    : `https://api.github.com/repos/${OWNER}/${REPO}/releases/latest`;

  const CACHE_KEY = `gh_release_${OWNER}_${REPO}_${TAG||"latest"}`;
  const now = Date.now();

  function setBtn(id, url) {
    const el = document.getElementById(id);
    if (!el) return;
    if (url) {
      el.href = url;
      el.classList.remove('disabled');
      el.style.opacity = '1';
      el.style.pointerEvents = 'auto';
    } else {
      el.href = '#';
      el.classList.add('disabled');
      el.style.opacity = '.6';
      el.style.pointerEvents = 'none';
    }
  }

  function setTotalCount(n) {
    const el = document.getElementById('cnt-total');
    if (el) el.textContent = `다운로드: ${Number(n||0).toLocaleString()}회`;
  }

  // 5분 캐시로 GitHub API 레이트 리밋 여유 확보
  try {
    const cached = localStorage.getItem(CACHE_KEY);
    if (cached) {
      const { ts, data } = JSON.parse(cached);
      if (now - ts < 5*60*1000) { apply(data); return; }
    }

    const res = await fetch(endpoint, {
      headers: { "Accept": "application/vnd.github+json" },
      cache: "no-store",
    });
    if (!res.ok) throw new Error(`GitHub API ${res.status}`);
    const rel = await res.json();
    localStorage.setItem(CACHE_KEY, JSON.stringify({ ts: now, data: rel }));
    apply(rel);
  } catch (e) {
    console.warn(e);
    setBtn('btn-mac', null);
    setBtn('btn-win', null);
    setTotalCount(0);
  }

  function apply(rel) {
    const assets = Array.isArray(rel.assets) ? rel.assets : [];
    // 파일명 규칙: -windows.exe / -macos.zip 
    const win = assets.find(a => a.name.toLowerCase().endsWith('-windows.exe') || a.name.toLowerCase().endsWith('.exe'));
    const mac = assets.find(a => a.name.toLowerCase().endsWith('-macos.zip')   || a.name.toLowerCase().includes('macos'));

    setBtn('btn-win', win && win.browser_download_url);
    setBtn('btn-mac', mac && mac.browser_download_url);

    const total = assets.reduce((s,a)=> s + (a.download_count||0), 0);
    setTotalCount(total);
  }
})();
</script>


<body>
  <div class="container">
    <header>
      <h1>📦 JW의 홈서버</h1>
    </header>
    <main>
      <div class="link-row">
        <a class="card" href="https://j30ngwoo.site/portfolio" target="_blank">
          🗂 포트폴리오
        </a>
        <a class="card" href="https://github.com/j30ngwoo" target="_blank">
          💻 Github
        </a>
        <a class="card" href="https://j30ngwoo.tistory.com/" target="_blank">
          ✍️ Tistory
        </a>
      </div>

      <div class="section-title">서버 타이머</div>
      <a class="card" href="https://j30ngwoo.site/server-timer/" target="_blank">
        ⏱️ 네이비즘보다 정확한 서버 타이머
      </a>
      

      <div class="section-title">상근 근무 시간표 제작 Tool</div>
      <a class="card" href="https://scheduler.j30ngwoo.site/" target="_blank">
        🔨 근무 시간표 제작 Tool
      </a>
      <a class="card" href="https://scheduler.j30ngwoo.site/api/swagger-ui/index.html" target="_blank">
        📢 Api Document
      </a>

      <div class="section-title">CSV 변환 Tool</div>
      <a class="card" href="http://info-csv.j30ngwoo.site/" target="_blank">
        🔨 학생정보 CSV 변환 Tool
      </a>

    </main>
    <footer>
      <p>&copy; 2025 JW Home Server</p>
    </footer>
  </div>
</body>
</html>
